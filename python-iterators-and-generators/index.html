<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.63.2"><meta name=viewport content="width=device-width,initial-scale=1"><title>Fantastic Iterators and How to Make Them &#183; Dacio's Tech Blog</title><meta name=description content><link type=text/css rel=stylesheet href=https://blog.dacio.dev/css/print.css media=print><link type=text/css rel=stylesheet href=https://blog.dacio.dev/css/poole.css><link type=text/css rel=stylesheet href=https://blog.dacio.dev/css/syntax.css><link type=text/css rel=stylesheet href=https://blog.dacio.dev/css/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png></head><body><aside class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://blog.dacio.dev/><h1>Dacio's Tech Blog</h1></a><p class=lead>The blog of an SF-based learner/programmer.</p></div><nav><ul class=sidebar-nav><li><a href=https://blog.dacio.dev/>Home</a></li></ul></nav><p>&copy; 2020. All rights reserved.</p></div></aside><main class="content container"><div class=post><h1>Fantastic Iterators and How to Make Them</h1><time datetime=2019-05-03T00:32:00-0700 class=post-date>Fri, May 3, 2019</time><h2 id=the-problem>The Problem</h2><p>While learning at Make School I&rsquo;ve seen my peers write functions that create lists of items.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span>s <span style=color:#f92672>=</span> <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>baacabcaab</span><span style=color:#e6db74>&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>p <span style=color:#f92672>=</span> <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>a</span><span style=color:#e6db74>&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>find_char</span>(string, character):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>  indices <span style=color:#f92672>=</span> list()
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>  <span style=color:#66d9ef>for</span> index, str_char <span style=color:#f92672>in</span> enumerate(string):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>    <span style=color:#66d9ef>if</span> str_char <span style=color:#f92672>==</span> character:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>      indices<span style=color:#f92672>.</span>append(index)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>  <span style=color:#66d9ef>return</span> indices
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#66d9ef>print</span>(find_char(s, p)) <span style=color:#75715e># [1, 2, 4, 7, 8]</span>
</code></pre></div><p>This implementation works, but it poses a few problems:</p><ul><li>What if we only want the first result; will we need to make an entirely new function?</li><li>What if all we do is loop over the result once, do we need to store every element in memory?</li></ul><p>Iterators are the ideal solution to these problems. They function like &ldquo;lazy lists&rdquo; in that instead of returning a list with every value it produces and returns each element one at a time.</p><blockquote><p>Iterators <strong>lazily</strong> return values; saving memory.</p></blockquote><p><em><strong>So let&rsquo;s dive into learning about them!</strong></em></p><h2 id=built-in-iterators>Built-In Iterators</h2><p>The iterators that are most often are <code>enumerate()</code>, and <code>zip()</code>. Both of these <em>lazily</em> return values by <code>next()</code> with them.</p><p><strong><code>range()</code>, however, is <em>not</em> an iterator, but an <em>&ldquo;lazy iterable."</em></strong> - <a href=https://treyhunner.com/2018/02/python-range-is-not-an-iterator/>Explanation</a></p><p>We can convert <code>range()</code> into an iterator with <code>iter()</code>, so we&rsquo;ll do that for our examples for the sake of learning.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>my_iter <span style=color:#f92672>=</span> iter(range(<span style=color:#ae81ff>10</span>))
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#66d9ef>print</span>(next(my_iter)) <span style=color:#75715e># 0</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#66d9ef>print</span>(next(my_iter)) <span style=color:#75715e># 1</span>
</code></pre></div><p>Upon each call of <code>next() </code>we get the next value in our range; makes sense right? If you want to convert an iterator it to a list you just give it the list constructor.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>my_iter <span style=color:#f92672>=</span> iter(range(<span style=color:#ae81ff>10</span>))
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#66d9ef>print</span>(list(my_iter)) <span style=color:#75715e># [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</code></pre></div><p>If we mimic this behavior we&rsquo;ll start to understand more about how iterators work.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span>my_iter <span style=color:#f92672>=</span> iter(range(<span style=color:#ae81ff>10</span>))
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>my_list <span style=color:#f92672>=</span> list()
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#66d9ef>try</span>:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>  <span style=color:#66d9ef>while</span> True:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>    my_list<span style=color:#f92672>.</span>append(next(my_iter))
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#66d9ef>except</span> <span style=color:#a6e22e>StopIteration</span>:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>  <span style=color:#66d9ef>pass</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#66d9ef>print</span>(my_list) <span style=color:#75715e># [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</code></pre></div><p>You can see that we needed to wrap it in a try catch statement. That&rsquo;s because iterators raise <code>StopIteration</code> when they&rsquo;ve been exhausted.</p><p>So if we call next on our exhausted range iterator, we&rsquo;ll get that error.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>next(my_iter) <span style=color:#75715e># Raises: StopIteration</span>
</code></pre></div><h2 id=making-an-iterator>Making an Iterator</h2><p>Let&rsquo;s try making an iterator that behaves like <code>range</code> with only the stop argument by using three common types of iterators: <a href=#class>Classes</a>, <a href=#generator-function>Generator Functions (Yield)</a> and <a href=#generator-expression>Generator Expressions</a></p><h3 id=class>Class</h3><p>The old way of creating an iterator was through an explicitly defined class. For an object to be an iterator it must implement <code>__iter__()</code> that returns itself and <code>__next__()</code> which returns the next value.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>my_range</span>:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>  _current <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>  <span style=color:#66d9ef>def</span> __init__(self, stop):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>    self<span style=color:#f92672>.</span>_stop <span style=color:#f92672>=</span> stop
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>  <span style=color:#66d9ef>def</span> __iter__(self):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>    <span style=color:#66d9ef>return</span> self
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>  <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__next__</span>(self):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>    self<span style=color:#f92672>.</span>_current <span style=color:#f92672>+</span><span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>_current <span style=color:#f92672>&gt;</span><span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>_stop:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>      <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>StopIteration</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>    <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_current
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>r <span style=color:#f92672>=</span> my_range(<span style=color:#ae81ff>10</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span style=color:#66d9ef>print</span>(list(r)) <span style=color:#75715e># [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</code></pre></div><p>That wasn&rsquo;t too hard, but unfortunately, we have to keep track of variables between calls of <code>next()</code>. Personally, I don&rsquo;t like the boilerplate or changing how I think about loops because it isn&rsquo;t a drop-in solution, so I prefer <a href=#generators>generators</a></p><p>The main benefit is that we can add additional functions that modify its internal variables such as <code>_stop</code> or create new iterators.</p><blockquote><p>Class iterators have the downside of needing boilerplate, however, they can have additional functions that modify state.</p></blockquote><h3 id=generators>Generators</h3><p><a href=https://www.python.org/dev/peps/pep-0255/>PEP 255</a> introduced &ldquo;simple generators&rdquo; using the <code>yield</code> keyword.</p><blockquote><p>Today, generators are iterators that are just easier to make than their class counterparts.</p></blockquote><h4 id=generator-function>Generator Function</h4><p>Generator functions are what was ultimately being discussed in that PEP and are my favorite type of iterator, so let&rsquo;s start with that.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_range</span>(stop):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>  index <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>  <span style=color:#66d9ef>while</span> index <span style=color:#f92672>&lt;</span> stop:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>    <span style=color:#66d9ef>yield</span> index
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span>    index <span style=color:#f92672>+</span><span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span>r <span style=color:#f92672>=</span> my_range(<span style=color:#ae81ff>10</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">9</span><span style=color:#66d9ef>print</span>(list(r)) <span style=color:#75715e># [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</code></pre></div><p>Do you see how beautiful those 4 lines of code are? It&rsquo;s slightly significantly shorter than our list implementation to top it off!</p><blockquote><p>Generator functions iterators with less boilerplate than classes with a normal logic flow.</p></blockquote><p>Generator functions automagically <strong>&ldquo;pause&rdquo;</strong> execution and return the specified value with every call of <code>next()</code>. This means that <em>no code</em> is run until the <strong>first</strong> <code>next()</code> call.</p><p>This means the flow is like this:</p><ol><li><code>next()</code> is called,</li><li>Code is executed up to the next <code>yield</code> statement.</li><li>The value on the right of <code>yield</code> is returned.</li><li>Execution is paused.</li><li>1-5 repeat for every <code>next()</code> call until the last line of code is hit.</li><li><code>StopIteration</code> is raised.</li></ol><p>Generator functions also allow for you to use the <code>yield from</code> keyword which future <code>next()</code> calls to another iterable until said iterable has been exhausted.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>yielded_range</span>():
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>  <span style=color:#66d9ef>yield</span> <span style=color:#f92672>from</span> my_range(<span style=color:#ae81ff>10</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span style=color:#66d9ef>print</span>(list(yielded_range())) <span style=color:#75715e># [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</code></pre></div><p>That wasn&rsquo;t a particularly complex example. But you can even do it <em>recursively</em>!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_range_recursive</span>(stop, current <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>  <span style=color:#66d9ef>if</span> current <span style=color:#f92672>&gt;</span><span style=color:#f92672>=</span> stop:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>    <span style=color:#66d9ef>return</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>  <span style=color:#66d9ef>yield</span> current
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span>  <span style=color:#66d9ef>yield</span> <span style=color:#f92672>from</span> my_range_recursive(stop, current <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span>r <span style=color:#f92672>=</span> my_range_recursive(<span style=color:#ae81ff>10</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">9</span><span style=color:#66d9ef>print</span>(list(r)) <span style=color:#75715e># [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</code></pre></div><h4 id=generator-expression>Generator Expression</h4><p>Generator expressions allow us to create iterators as one-liners and are good when we don&rsquo;t need to give it external functions. Unfortunately, we can&rsquo;t make another <code>my_range</code> using an expression, but we can work on iterables like our last <code>my_range</code> function.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>my_doubled_range_10 <span style=color:#f92672>=</span> (x <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> my_range(<span style=color:#ae81ff>10</span>))
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#66d9ef>print</span>(list(my_doubled_range_10)) <span style=color:#75715e># 0, 2, 4, 6, 8, 10, 12, 14, 16, 18]</span>
</code></pre></div><p>The cool thing about this is that it does the following:</p><ol><li>The <code>list</code> asks <code>my_doubled_range_10</code> for its next value.</li><li><code>my_doubled_range_10</code> asks <code>my_range</code> for its next value.</li><li><code>my_doubled_range_10</code> returns <code>my_range</code>'s value multiplied by 2.</li><li>The <code>list</code> appends the value to itself.</li><li>1-5 repeat until <code>my_doubled_range_10</code> raises <code>StopIteration</code> which happens when <code>my_range</code> does.</li><li>The <code>list</code> is returned containing each value returned by <code>my_doubled_range</code>.</li></ol><p>We can even do <em>filtering</em> using generator expressions!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>my_even_range_10 <span style=color:#f92672>=</span> (x <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> my_range(<span style=color:#ae81ff>10</span>) <span style=color:#66d9ef>if</span> x <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#66d9ef>print</span>(list(my_even_range_10)) <span style=color:#75715e># [0, 2, 4, 6, 8]</span>
</code></pre></div><p>This is very similar to the previous except <code>my_even_range_10</code> only returns values that match the given condition, so only even values between in the range [0, 10).</p><p>Throughout all of this, we only create a list because we told it to.</p><h2 id=the-benefit>The Benefit</h2><p>Because generators are iterators, iterators are iterables, and iterators lazily return values. This means that using this knowledge we can create objects that will only give us objects when we ask for them and however many we like.</p><p>This means we can pass generators into functions that reduce each other.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>print</span>(sum(my_range(<span style=color:#ae81ff>10</span>))) <span style=color:#75715e># 45</span>
</code></pre></div><p>Calculating the sum in this way avoids creating a list when all we&rsquo;re doing is adding them together and then discarding.</p><p>We can rewrite the very <a href=#the-problem>first example</a> to be much better using a generator function!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>s <span style=color:#f92672>=</span> <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>baacabcaab</span><span style=color:#e6db74>&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>p <span style=color:#f92672>=</span> <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>a</span><span style=color:#e6db74>&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>find_char</span>(string, character):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>  <span style=color:#66d9ef>for</span> index, str_char <span style=color:#f92672>in</span> enumerate(string):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span>    <span style=color:#66d9ef>if</span> str_char <span style=color:#f92672>==</span> character:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span>      <span style=color:#66d9ef>yield</span> index
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">9</span><span style=color:#66d9ef>print</span>(list(find_char(s, p))) <span style=color:#75715e># [1, 2, 4, 7, 8]</span>
</code></pre></div><p>Now immediately there might be no obvious benefit, but let&rsquo;s go to my first question: &ldquo;what if we only want the first result; will we need to make an entirely new function?&rdquo;</p><blockquote><p>With a generator function we don&rsquo;t need to rewrite as much logic.</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>print</span>(next(find_char(s, p))) <span style=color:#75715e># 1</span>
</code></pre></div><p>Now we <em>could</em> retrieve the first value of the list that our original solution gave, but this way we only get the first match and stop iterating over the list. The generator will be then discarded and nothing else is created; massively saving memory.</p><h2 id=conclusion>Conclusion</h2><p>If you&rsquo;re ever creating a function the accumulates values in a list like this.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>foo</span>(bar):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>  values <span style=color:#f92672>=</span> []
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>  <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> bar:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>    <span style=color:#75715e># some logic</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span>    values<span style=color:#f92672>.</span>append(x)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span>  <span style=color:#66d9ef>return</span> values
</code></pre></div><p>Consider making it return an iterator with a class, generator function, or generator expression like so:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>foo</span>(bar):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>  <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> bar:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>    <span style=color:#75715e># some logic</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>    <span style=color:#66d9ef>yield</span> x
</code></pre></div><h2 id=resources-and-sources>Resources and Sources</h2><h4 id=peps>PEPs</h4><ul><li><a href=https://www.python.org/dev/peps/pep-0255/>Generators</a></li><li><a href=https://www.python.org/dev/peps/pep-0289/>Generator Expressions PEP</a></li><li><a href=https://www.python.org/dev/peps/pep-0380/>Yield From PEP</a></li></ul><h2 id=articles-and-threads>Articles and Threads</h2><ul><li><a href=https://www.programiz.com/python-programming/iterator>Iterators</a></li><li><a href=https://www.geeksforgeeks.org/python-difference-iterable-iterator/>Iterable vs Iterator</a></li><li><a href=https://wiki.python.org/moin/Generator>Generator Documentation</a></li><li><a href=https://nvie.com/posts/iterators-vs-generators/>Iterators vs Generators</a></li><li><a href=https://stackoverflow.com/a/1995585>Generator Expression vs Function</a></li><li><a href=https://stackoverflow.com/a/8991864>Recrusive Generators</a></li></ul><h3 id=definitions>Definitions</h3><ul><li><a href=https://docs.python.org/3/glossary.html#term-iterable>Iterable</a></li><li><a href=https://docs.python.org/3/glossary.html#term-iterator>Iterator</a></li><li><a href=https://docs.python.org/3/glossary.html#term-generator>Generator</a></li><li><a href=https://docs.python.org/3/glossary.html#term-generator-iterator>Generator Iterator</a></li><li><a href=https://docs.python.org/3/glossary.html#term-generator-expression>Generator Expression</a></li></ul></div><h2>Comments</h2><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"dacio"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></main></body></html>